function current_branch() {
    ref=$(git symbolic-ref HEAD 2> /dev/null) || return
    echo ${ref#refs/heads/}
}

if [[ $ZSH_VERSION == 3.1.1<6-> || $ZSH_VERSION == <4->* ]]; then
    echo "Current branch"
    GIT_MESSAGE=$(current_branch)
else
    autoload -Uz vcs_info
    zstyle ':vcs_info:*' check-for-changes true
    zstyle ':vcs_info:*' enable git svn hg
    precmd() {
        vcs_info
    }

    GIT_MESSAGE=${vcs_info_msg_0_}
fi
